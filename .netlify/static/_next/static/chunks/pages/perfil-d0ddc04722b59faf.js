(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4495],{3265:function(e,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/perfil",function(){return a(3801)}])},1313:function(e,n,a){"use strict";var t=a(3077),r=a(5893);n.Z=(0,t.Z)((0,r.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},8963:function(e,n,a){"use strict";var t=a(3077),r=a(5893);n.Z=(0,t.Z)((0,r.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},3801:function(e,n,a){"use strict";a.r(n),a.d(n,{default:function(){return q}});var t=a(5893),r=a(7294),i=a(1163),o=a(2874),s=a(8426),l=a(6788),d=a(3490),m=a(4677),c=a(8864),h=a(5895),u=a(6912),x=a(7788),f=a(7462),p=a(3366),v=a(512),Z=a(4780),j=a(7527),b=a(4001),g=a(1588),S=a(4867);function y(e){return(0,S.ZP)("MuiAlertTitle",e)}(0,g.Z)("MuiAlertTitle",["root"]);let A=["className"],w=e=>{let{classes:n}=e;return(0,Z.Z)({root:["root"]},y,n)},C=(0,j.ZP)(l.Z,{name:"MuiAlertTitle",slot:"Root",overridesResolver:(e,n)=>n.root})(e=>{let{theme:n}=e;return{fontWeight:n.typography.fontWeightMedium,marginTop:-2}}),P=r.forwardRef(function(e,n){let a=(0,b.i)({props:e,name:"MuiAlertTitle"}),{className:r}=a,i=(0,p.Z)(a,A),o=w(a);return(0,t.jsx)(C,(0,f.Z)({gutterBottom:!0,component:"div",ownerState:a,ref:n,className:(0,v.Z)(o.root,r)},i))});var E=a(8573),W=a(492),N=a(5611),_=a(2857),M=a(1313),z=a(7698),k=a(9122),I=a(8963),T=a(3362),D=a(5930);function R(){var e;let{user:n,updateUser:a}=(0,o.aC)();(0,i.useRouter)();let[f,p]=(0,r.useState)(!1),[v,Z]=(0,r.useState)(""),[j,b]=(0,r.useState)(""),[g,S]=(0,r.useState)(!1),[y,A]=(0,r.useState)(!1),[w,C]=(0,r.useState)(null),[D,R]=(0,r.useState)({nome:"",email:"",senhaAtual:"",novaSenha:"",confirmarSenha:""});(0,r.useEffect)(()=>{n&&(C({id:n.id,nome:n.nome||"",email:n.email||"",tipo:n.tipo,ativo:!1!==n.ativo}),R(e=>({...e,nome:n.nome||"",email:n.email||""})))},[n]);let q=e=>{let{name:n,value:a}=e.target;R(e=>({...e,[n]:a}))},U=async e=>{e.preventDefault(),p(!0),Z(""),b("");try{if(D.novaSenha||D.confirmarSenha){if(D.novaSenha!==D.confirmarSenha)throw Error("As senhas n\xe3o conferem");if(D.novaSenha.length<6)throw Error("A nova senha deve ter no m\xednimo 6 caracteres")}let e=await T.h.put("/api/auth/perfil",{nome:D.nome,email:D.email,senhaAtual:D.senhaAtual||void 0,novaSenha:D.novaSenha||void 0});a(e.data.user),b("Perfil atualizado com sucesso!"),S(!1),R(e=>({...e,senhaAtual:"",novaSenha:"",confirmarSenha:""}))}catch(e){var n,t;Z((null===(t=e.response)||void 0===t?void 0:null===(n=t.data)||void 0===n?void 0:n.message)||e.message||"Erro ao atualizar perfil")}finally{p(!1)}};return w?(0,t.jsxs)(s.Z,{maxWidth:"md",sx:{py:4},children:[(0,t.jsxs)(d.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[(0,t.jsx)(l.Z,{variant:"h4",component:"h1",fontWeight:"bold",children:"Meu Perfil"}),(0,t.jsx)(m.Z,{variant:g?"outlined":"contained",color:"primary",startIcon:(0,t.jsx)(M.Z,{}),onClick:()=>S(!g),children:g?"Cancelar":"Editar Perfil"})]}),(0,t.jsxs)(c.Z,{elevation:2,sx:{p:4,mb:4},children:[(0,t.jsxs)(d.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mb:4},children:[(0,t.jsx)(h.Z,{sx:{width:120,height:120,fontSize:48,mb:2,bgcolor:"primary.main"},children:(null===(e=w.nome)||void 0===e?void 0:e.charAt(0).toUpperCase())||"U"}),(0,t.jsxs)(d.Z,{sx:{textAlign:"center",mb:2},children:[(0,t.jsx)(l.Z,{variant:"h5",component:"div",fontWeight:"bold",children:w.nome}),(0,t.jsx)(l.Z,{variant:"body2",color:"text.secondary",children:w.email}),(0,t.jsx)(d.Z,{component:"span",sx:{display:"inline-block",bgcolor:"ADMIN"===w.tipo?"secondary.main":"primary.main",color:"white",px:1.5,py:.5,borderRadius:4,fontSize:"0.75rem",fontWeight:"bold",mt:1},children:"ADMIN"===w.tipo?"Administrador":"Usu\xe1rio"})]})]}),(0,t.jsx)(u.Z,{sx:{my:3}}),v&&(0,t.jsxs)(x.Z,{severity:"error",sx:{mb:3},children:[(0,t.jsx)(P,{children:"Erro"}),v]}),j&&(0,t.jsxs)(x.Z,{severity:"success",sx:{mb:3},children:[(0,t.jsx)(P,{children:"Sucesso"}),j]}),(0,t.jsx)(d.Z,{component:"form",onSubmit:U,children:(0,t.jsxs)(E.ZP,{container:!0,spacing:3,children:[(0,t.jsx)(E.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(W.Z,{fullWidth:!0,label:"Nome Completo",name:"nome",value:D.nome,onChange:q,disabled:!g||f,margin:"normal",required:!0})}),(0,t.jsx)(E.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(W.Z,{fullWidth:!0,label:"E-mail",name:"email",type:"email",value:D.email,onChange:q,disabled:!g||f,margin:"normal",required:!0})}),g&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(E.ZP,{item:!0,xs:12,children:[(0,t.jsx)(l.Z,{variant:"subtitle1",fontWeight:"bold",gutterBottom:!0,children:"Alterar Senha"}),(0,t.jsx)(l.Z,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Deixe em branco se n\xe3o quiser alterar a senha."})]}),(0,t.jsx)(E.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(W.Z,{fullWidth:!0,label:"Senha Atual",name:"senhaAtual",type:y?"text":"password",value:D.senhaAtual,onChange:q,disabled:f,margin:"normal",InputProps:{endAdornment:(0,t.jsx)(N.Z,{position:"end",children:(0,t.jsx)(_.Z,{onClick:()=>A(!y),edge:"end",children:y?(0,t.jsx)(z.Z,{}):(0,t.jsx)(k.Z,{})})})}})}),(0,t.jsx)(E.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(W.Z,{fullWidth:!0,label:"Nova Senha",name:"novaSenha",type:y?"text":"password",value:D.novaSenha,onChange:q,disabled:f,margin:"normal"})}),(0,t.jsx)(E.ZP,{item:!0,xs:12,md:6,children:(0,t.jsx)(W.Z,{fullWidth:!0,label:"Confirmar Nova Senha",name:"confirmarSenha",type:y?"text":"password",value:D.confirmarSenha,onChange:q,disabled:f,margin:"normal"})})]}),g&&(0,t.jsx)(E.ZP,{item:!0,xs:12,sx:{mt:2},children:(0,t.jsx)(m.Z,{type:"submit",variant:"contained",color:"primary",size:"large",disabled:f,startIcon:(0,t.jsx)(I.Z,{}),children:f?"Salvando...":"Salvar Altera\xe7\xf5es"})})]})})]})]}):(0,t.jsx)(s.Z,{maxWidth:"md",sx:{py:4},children:(0,t.jsx)(l.Z,{variant:"h6",align:"center",children:"Carregando..."})})}function q(){return(0,t.jsx)(D.Z,{children:(0,t.jsx)(R,{})})}}},function(e){e.O(0,[8426,492,8573,6,2888,9774,179],function(){return e(e.s=3265)}),_N_E=e.O()}]);