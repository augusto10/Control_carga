(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3866],{4089:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/motoristas",function(){return r(8991)}])},8264:function(e,n,r){"use strict";r.d(n,{Z:function(){return d}});var s=r(5893),a=r(1163),t=r(7294),o=r(2874),i=r(7182),l=r(3490),c=r(4178);function d(e){let{children:n}=e,{user:r,isAuthenticated:d,isLoading:u}=(0,o.aC)(),h=(0,a.useRouter)(),[x,Z]=(0,t.useState)(!0);return((0,t.useEffect)(()=>{if(!u){if(!d){console.log("[AdminRoute] Usu\xe1rio n\xe3o autenticado, redirecionando para login..."),h.push("/login");return}if(r&&r.tipo!==c.W.ADMIN){console.log("[AdminRoute] Acesso negado: usu\xe1rio n\xe3o \xe9 administrador"),h.push("/acesso-negado");return}Z(!1)}},[u,d,r,h]),u||x)?(0,s.jsx)(l.Z,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",children:(0,s.jsx)(i.Z,{})}):d&&(null==r?void 0:r.tipo)===c.W.ADMIN?(0,s.jsx)(s.Fragment,{children:n}):null}},3839:function(e,n,r){"use strict";var s=r(3077),a=r(5893);n.Z=(0,s.Z)((0,a.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},9090:function(e,n,r){"use strict";var s=r(3077),a=r(5893);n.Z=(0,s.Z)((0,a.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},1313:function(e,n,r){"use strict";var s=r(3077),a=r(5893);n.Z=(0,s.Z)((0,a.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},8991:function(e,n,r){"use strict";r.r(n);var s=r(5893),a=r(7294),t=r(8426),o=r(6788),i=r(8864),l=r(4677),c=r(5026),d=r(6592),u=r(360),h=r(6577),x=r(8863),Z=r(9827),j=r(8690),m=r(2857),p=r(7182),f=r(3453),v=r(2365),g=r(110),C=r(492),y=r(5972),E=r(6727),N=r(4925),w=r(7788),M=r(3839),_=r(1313),k=r(9090),z=r(3362),I=r(8264);function S(){let[e,n]=(0,a.useState)([]),[r,I]=(0,a.useState)([]),[S,W]=(0,a.useState)(!0),[b,A]=(0,a.useState)(!1),[H,T]=(0,a.useState)(null),[P,q]=(0,a.useState)(!1),[D,F]=(0,a.useState)({open:!1,message:"",severity:"success"});(0,a.useEffect)(()=>{O()},[]);let O=async()=>{try{W(!0);let[e,r]=await Promise.all([z.h.get("/api/motoristas"),z.h.get("/api/transportadoras")]);n(e.data),I(r.data)}catch(e){console.error(e),F({open:!0,message:"Erro ao carregar dados",severity:"error"})}finally{W(!1)}},R=e=>{T({...e}),q(!0),A(!0)},V=()=>{A(!1),T(null)},X=e=>{let{name:n,value:r}=e.target;T(e=>({...e,[n]:r}))},B=async()=>{if(H)try{W(!0),P?(await z.h.put("/api/motoristas/".concat(H.id),H),F({open:!0,message:"Motorista atualizado!",severity:"success"})):(await z.h.post("/api/motoristas",H),F({open:!0,message:"Motorista criado!",severity:"success"})),V(),await O()}catch(e){console.error(e),F({open:!0,message:"Erro ao salvar",severity:"error"})}finally{W(!1)}},L=async e=>{if(confirm("Excluir motorista?"))try{await z.h.delete("/api/motoristas/".concat(e)),await O()}catch(e){console.error(e),F({open:!0,message:"Erro ao excluir",severity:"error"})}};return(0,s.jsxs)(t.Z,{maxWidth:"lg",sx:{mt:4},children:[(0,s.jsx)(o.Z,{variant:"h4",gutterBottom:!0,children:"Motoristas"}),(0,s.jsx)(i.Z,{sx:{p:2},children:(0,s.jsx)(l.Z,{variant:"contained",startIcon:(0,s.jsx)(M.Z,{}),onClick:()=>{T({nome:"",telefone:"",cpf:"",cnh:"",transportadoraId:""}),q(!1),A(!0)},children:"Novo Motorista"})}),(0,s.jsxs)(c.Z,{component:i.Z,sx:{mt:2},children:[(0,s.jsxs)(d.Z,{size:"small",children:[(0,s.jsx)(u.Z,{children:(0,s.jsxs)(h.Z,{children:[(0,s.jsx)(x.Z,{children:"Nome"}),(0,s.jsx)(x.Z,{children:"Telefone"}),(0,s.jsx)(x.Z,{children:"CPF"}),(0,s.jsx)(x.Z,{children:"CNH"}),(0,s.jsx)(x.Z,{children:"Transportadora"}),(0,s.jsx)(x.Z,{align:"right",children:"A\xe7\xf5es"})]})}),(0,s.jsx)(Z.Z,{children:e.map(e=>{var n;return(0,s.jsxs)(h.Z,{children:[(0,s.jsx)(x.Z,{children:e.nome}),(0,s.jsx)(x.Z,{children:e.telefone}),(0,s.jsx)(x.Z,{children:e.cpf}),(0,s.jsx)(x.Z,{children:e.cnh}),(0,s.jsx)(x.Z,{children:(null===(n=e.transportadora)||void 0===n?void 0:n.descricao)||e.transportadoraId}),(0,s.jsxs)(x.Z,{align:"right",children:[(0,s.jsx)(j.Z,{title:"Editar",children:(0,s.jsx)(m.Z,{onClick:()=>R(e),children:(0,s.jsx)(_.Z,{})})}),(0,s.jsx)(j.Z,{title:"Excluir",children:(0,s.jsx)(m.Z,{onClick:()=>L(e.id),color:"error",children:(0,s.jsx)(k.Z,{})})})]})]},e.id)})})]}),S&&(0,s.jsx)(p.Z,{sx:{m:2}})]}),(0,s.jsxs)(f.Z,{open:b,onClose:V,fullWidth:!0,children:[(0,s.jsxs)(v.Z,{children:[P?"Editar":"Novo"," Motorista"]}),(0,s.jsxs)(g.Z,{children:[(0,s.jsx)(C.Z,{label:"Nome",name:"nome",value:(null==H?void 0:H.nome)||"",onChange:X,fullWidth:!0,margin:"normal",required:!0}),(0,s.jsx)(C.Z,{label:"Telefone",name:"telefone",value:(null==H?void 0:H.telefone)||"",onChange:X,fullWidth:!0,margin:"normal"}),(0,s.jsx)(C.Z,{label:"CPF",name:"cpf",value:(null==H?void 0:H.cpf)||"",onChange:X,fullWidth:!0,margin:"normal",required:!0}),(0,s.jsx)(C.Z,{label:"CNH",name:"cnh",value:(null==H?void 0:H.cnh)||"",onChange:X,fullWidth:!0,margin:"normal",required:!0}),(0,s.jsx)(C.Z,{select:!0,label:"Transportadora",name:"transportadoraId",value:(null==H?void 0:H.transportadoraId)||"",onChange:X,fullWidth:!0,margin:"normal",required:!0,children:r.map(e=>(0,s.jsx)(y.Z,{value:e.id,children:e.descricao},e.id))})]}),(0,s.jsxs)(E.Z,{children:[(0,s.jsx)(l.Z,{onClick:V,children:"Cancelar"}),(0,s.jsx)(l.Z,{variant:"contained",onClick:B,disabled:S||!(null==H?void 0:H.nome)||!(null==H?void 0:H.cpf)||!(null==H?void 0:H.transportadoraId),children:S?(0,s.jsx)(p.Z,{size:24}):"Salvar"})]})]}),(0,s.jsx)(N.Z,{open:D.open,autoHideDuration:4e3,onClose:()=>F({...D,open:!1}),anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,s.jsx)(w.Z,{severity:D.severity,onClose:()=>F({...D,open:!1}),children:D.message})})]})}n.default=()=>(0,s.jsx)(I.Z,{children:(0,s.jsx)(S,{})})}},function(e){e.O(0,[8426,492,8690,4424,6875,4793,2888,9774,179],function(){return e(e.s=4089)}),_N_E=e.O()}]);